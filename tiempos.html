<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Analisis de tiempos Secado Mec谩nico</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* RESET Y BASE */
    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0; 
      -webkit-tap-highlight-color: transparent;
    }
    
    body { 
      font-family: 'Segoe UI', 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif; 
      background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%); 
      color: #333; 
      padding: 16px;
      line-height: 1.5;
      min-height: 100vh;
    }

    /* CABECERA */
    .header {
      text-align: center;
      margin-bottom: 24px;
      padding: 16px;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(31, 60, 136, 0.08);
    }
    
    .header h1 {
      font-size: 1.5rem;
      color: #1f3c88;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    .header i {
      color: #4a6fc1;
    }

    /* SECCIONES */
    .section { 
      margin-bottom: 24px; 
      background: #fff; 
      padding: 20px; 
      border-radius: 16px; 
      box-shadow: 0 4px 16px rgba(0,0,0,0.08);
      position: relative;
      overflow: hidden;
    }
    
    .section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(to right, #1f3c88, #4a6fc1);
      border-radius: 16px 16px 0 0;
    }

    /* TTULOS DE SECCIN */
    .section-header { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      margin-bottom: 20px;
    }
    
    .section-header h2 { 
      font-size: 1.3rem; 
      color: #1f3c88; 
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .section-header i {
      font-size: 1.1rem;
    }

    /* TARJETAS */
    .cards { 
      display: grid; 
      gap: 16px; 
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
    }
    
    /* Colores arm贸nicos para las primeras 3 tarjetas de cada secci贸n */
    .card:nth-child(1) { 
      background: linear-gradient(135deg, #4a6fc1, #6a8ad8);
      color: white;
    }
    
    .card:nth-child(2) { 
      background: linear-gradient(135deg, #43a1a9, #5cc2cc);
      color: white;
    }
    
    .card:nth-child(3) { 
      background: linear-gradient(135deg, #f0933b, #ffb347);
      color: white;
    }
    
    /* Tarjetas del 4 en adelante */
    .card:nth-child(n+4) { 
      background: linear-gradient(135deg, #ffffff, #f0f5ff);
      color: #333;
    }
    
    .card { 
      padding: 18px 14px; 
      border-radius: 14px; 
      text-align: center; 
      box-shadow: 0 4px 8px rgba(0,0,0,0.1); 
      transition: all 0.3s ease; 
      display: flex;
      flex-direction: column;
      justify-content: center;
      min-height: 110px;
      position: relative;
      overflow: hidden;
    }
    
    .card::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(rgba(255,255,255,0.1), rgba(0,0,0,0.05));
      pointer-events: none;
    }
    
    .card:hover, .card:active { 
      transform: translateY(-5px); 
      box-shadow: 0 8px 20px rgba(0,0,0,0.15); 
    }
    
    .card-title { 
      font-weight: 600; 
      font-size: 0.9rem; 
      margin-bottom: 8px; 
      line-height: 1.3;
    }
    
    .card:nth-child(-n+3) .card-title {
      color: rgba(255,255,255,0.95);
    }
    
    .card:nth-child(n+4) .card-title {
      color: #0d2b4a;
    }
    
    .card-value { 
      font-size: 1.5rem; 
      font-weight: bold; 
      margin-top: 4px;
    }
    
    .card:nth-child(-n+3) .card-value {
      color: white;
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .card:nth-child(n+4) .card-value {
      color: #1f3c88;
    }

    /* BOTONES Y FILTROS */
    .toggle-btn { 
      padding: 10px 16px; 
      border-radius: 10px; 
      border: none; 
      background: linear-gradient(to right, #1f3c88, #4a6fc1); 
      color: #fff; 
      cursor: pointer; 
      font-size: 0.9rem; 
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s;
      box-shadow: 0 2px 6px rgba(31, 60, 136, 0.3);
    }
    
    .toggle-btn:active { 
      transform: scale(0.98); 
      box-shadow: 0 1px 3px rgba(31, 60, 136, 0.3);
    }
    
    .filter { 
      margin-bottom: 20px; 
      display: flex; 
      align-items: center; 
      gap: 12px; 
      flex-wrap: wrap;
      background: #f8faff;
      padding: 16px;
      border-radius: 12px;
    }
    
    .filter label { 
      font-weight: 600;
      color: #1f3c88;
      font-size: 0.95rem;
    }
    
    select { 
      padding: 12px 16px; 
      border-radius: 10px; 
      border: 1px solid #d1d9ff; 
      background-color: #fff; 
      cursor: pointer; 
      font-size: 0.95rem; 
      flex-grow: 1;
      color: #333;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    select:focus {
      outline: none;
      border-color: #4a6fc1;
      box-shadow: 0 0 0 3px rgba(74, 111, 193, 0.2);
    }

    /* LOADING Y ERROR */
    .loading {
      text-align: center;
      padding: 40px 20px;
      color: #4a6fc1;
    }
    
    .error {
      text-align: center;
      padding: 20px;
      background: #ffeaea;
      border-radius: 12px;
      color: #d32f2f;
      margin-top: 20px;
    }
    
    .refresh-btn {
      margin-top: 15px;
      padding: 10px 20px;
      background: #1f3c88;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
    }

    /* RESPONSIVE */
    @media (max-width: 768px) {
      body { padding: 12px; }
      .header { padding: 14px; }
      .section { padding: 18px 16px; }
      .cards { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); }
      .card { padding: 16px 12px; min-height: 100px; }
      .card-value { font-size: 1.4rem; }
    }
    
    @media (max-width: 480px) {
      .cards { grid-template-columns: 1fr 1fr; gap: 12px; }
      .section-header { flex-direction: column; align-items: flex-start; gap: 12px; }
      .toggle-btn { align-self: flex-start; }
      .filter { flex-direction: column; align-items: flex-start; }
      select { width: 100%; }
      .card-title { font-size: 0.85rem; }
      .card-value { font-size: 1.3rem; }
    }
    
    /* Mejoras para toques en Android */
    @media (hover: none) and (pointer: coarse) {
      .card:hover { transform: none; }
      .card:active { transform: translateY(-3px); }
      .toggle-btn:hover { background: linear-gradient(to right, #1f3c88, #4a6fc1); }
      .toggle-btn:active { background: linear-gradient(to right, #163266, #3a5aad); }
    }
    
    /* Animaciones */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .card {
      animation: fadeIn 0.5s ease forwards;
      opacity: 0;
    }
    
    .card:nth-child(1) { animation-delay: 0.1s; }
    .card:nth-child(2) { animation-delay: 0.2s; }
    .card:nth-child(3) { animation-delay: 0.3s; }
    .card:nth-child(4) { animation-delay: 0.4s; }
    .card:nth-child(5) { animation-delay: 0.5s; }
    .card:nth-child(6) { animation-delay: 0.6s; }
    .card:nth-child(7) { animation-delay: 0.7s; }
    .card:nth-child(8) { animation-delay: 0.8s; }
    .card:nth-child(9) { animation-delay: 0.9s; }
    .card:nth-child(10) { animation-delay: 1.0s; }
    
    /* Scroll suave */
    html {
      scroll-behavior: smooth;
    }
  </style>
</head>
<body>
  <!-- CABECERA -->
  <div class="header">
    <h1><i class="fas fa-chart-line"></i> Analisis de tiempos Secado Mec谩nico</h1>
  </div>

  <!-- SECCIN 1 -->
  <div class="section" id="promedios-generales">
    <div class="section-header">
      <h2><i class="fas fa-chart-bar"></i> Generales</h2>
    </div>
    <div class="cards" id="cards-generales">
      <div class="loading">
        <i class="fas fa-spinner fa-spin"></i> Cargando datos generales...
      </div>
    </div>
  </div>

  <!-- SECCIN 2 -->
  <div class="section" id="tren-verticales">
    <div class="section-header">
      <h2><i class="fas fa-industry"></i> Verticales</h2>
      <button class="toggle-btn" onclick="toggleSection('cards-trenes')">
        <i class="fas fa-eye"></i> <span class="toggle-text">Mostrar</span>
      </button>
    </div>
    <div class="cards" id="cards-trenes" style="display:none;"></div>
  </div>

  <!-- SECCIN 3 -->
  <div class="section" id="guardiolas">
    <div class="section-header">
      <h2><i class="fas fa-tachometer-alt"></i> Guardiolas</h2>
      <button class="toggle-btn" onclick="toggleSection('cards-guardiolas')">
        <i class="fas fa-eye"></i> <span class="toggle-text">Mostrar</span>
      </button>
    </div>
    <div class="filter">
      <label for="guardiolas-filter"><i class="fas fa-filter"></i> Filtrar:</label>
      <select id="guardiolas-filter">
        <option value="general">Todos</option>
        <option value="directas">Cargas directas</option>
        <option value="completos">Ciclos completos</option>
      </select>
    </div>
    <div class="cards" id="cards-guardiolas" style="display:none;"></div>
  </div>
<!-- BOTN FLOTANTE -->
<a href="index.html" id="boton-flotante" class="boton-flotante"> Inicio</a>

<style>
/* Estilo del bot贸n flotante */
.boton-flotante {
  position: fixed;
  bottom: 20px;               /* Distancia desde abajo */
  right: 20px;                /* Distancia desde la derecha */
  background-color: #007BFF;  /* Color azul */
  color: white;
  padding: 15px 20px;
  border-radius: 50px;
  text-decoration: none;
  font-weight: bold;
  font-size: 16px;
  opacity: 0.7;               /* Transparencia inicial */
  transition: opacity 0.3s, transform 0.3s;
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
  z-index: 1000;
}

.boton-flotante:hover {
  opacity: 1;                 /* Opaco al pasar el mouse */
  transform: scale(1.1);      /* Zoom sutil */
}

.boton-flotante.oculto {
  opacity: 0;
  transform: scale(0);
  pointer-events: none;       /* No se puede clicar mientras desaparece */
  transition: opacity 0.5s, transform 0.5s;
}
</style>

<script>
// Funci贸n para animar y redirigir al pulsar
const boton = document.getElementById('boton-flotante');

boton.addEventListener('click', function(e) {
  e.preventDefault();              // Evita que navegue de inmediato
  boton.classList.add('oculto');   // A帽ade animaci贸n de salida

  setTimeout(() => {
    window.location.href = boton.href; // Redirige tras animaci贸n
  }, 500); // Coincide con la transici贸n CSS
});
</script>

  <!-- MENSAJES DE ERROR -->
  <div id="error-container" style="display:none;"></div>

  <script>
    const SPREADSHEET_URL = "https://docs.google.com/spreadsheets/d/1lFHQO8f33dK2W9tDbg0_74_0fddNU449ooAy-WuHdvg/export?format=csv&gid=845379377";

    const headers = {
      generales: ["Promedio general de secado","Promedio de ciclo en verticales","Promedio general de secado en guardiolas"],
      trenes: ["Promedio de ciclo tren 1","Promedio de ciclo tren 2","Promedio de ciclo vertical 1","Promedio de ciclo vertical 2","Promedio de ciclo vertical 3","Promedio de ciclo vertical 4","Promedio de ciclo vertical 5","Promedio de ciclo vertical 6","Promedio de ciclo vertical 7","Promedio de ciclo vertical 8"],
      guardiolas: {
        general: ["Promedio general de secado en guardiolas","TiemposTren1Guardiolas","TiemposTren2Guardiolas","Promedio G1","Promedio G2","Promedio G3","Promedio G4","Promedio G5","Promedio G6","Promedio G7","Promedio G8","Promedio G9","Promedio G10","Promedio G11","Promedio G12","Promedio G13","Promedio G14","Promedio G15","Promedio G16","Promedio G17","Promedio G18"],
        directas: ["Promedio general de secado de cargas directas a guardiolas","Promedio cargas directas Tren 1","Promedio cargas directas Tren 2","Promedio cargas directas G1","Promedio cargas directas G2","Promedio cargas directas G3","Promedio cargas directas G4","Promedio cargas directas G5","Promedio cargas directas G6","Promedio cargas directas G7","Promedio cargas directas G8","Promedio cargas directas G9","Promedio cargas directas G10","Promedio cargas directas G11","Promedio cargas directas G12","Promedio cargas directas G13","Promedio cargas directas G14","Promedio cargas directas G15","Promedio cargas directas G16","Promedio cargas directas G17","Promedio cargas directas G18"],
        completos: ["Promedio general de secado ciclo completo","Promedio ciclo completo Tren 1","Promedio ciclo completo Tren 2","Promedio ciclo completo G1","Promedio ciclo completo G2","Promedio ciclo completo G3","Promedio ciclo completo G4","Promedio ciclo completo G5","Promedio ciclo completo G6","Promedio ciclo completo G7","Promedio ciclo completo G8","Promedio ciclo completo G9","Promedio ciclo completo G10","Promedio ciclo completo G11","Promedio ciclo completo G12","Promedio ciclo completo G13","Promedio ciclo completo G14","Promedio ciclo completo G15","Promedio ciclo completo G16","Promedio ciclo completo G17","Promedio ciclo completo G18"]
      }
    };

    function renderCards(containerId, labels, data) {
      const container = document.getElementById(containerId);
      container.innerHTML = "";
      
      // Si no hay datos, mostrar mensaje
      if (!data || Object.keys(data).length === 0) {
        container.innerHTML = `<div class="error">No hay datos disponibles</div>`;
        return;
      }
      
      // Crear tarjetas
      labels.forEach(label => {
        const value = data[label]?.trim() || "-";
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <div class="card-title">${label}</div>
          <div class="card-value">${value}</div>
        `;
        container.appendChild(card);
      });
    }

    function toggleSection(id) {
      const el = document.getElementById(id);
      const isHidden = el.style.display === "none";
      el.style.display = isHidden ? "grid" : "none";
      
      // Actualizar texto del bot贸n
      const btn = el.closest(".section").querySelector(".toggle-btn");
      const icon = btn.querySelector("i");
      const text = btn.querySelector(".toggle-text");
      
      if (isHidden) {
        icon.className = "fas fa-eye-slash";
        text.textContent = "Ocultar";
      } else {
        icon.className = "fas fa-eye";
        text.textContent = "Mostrar";
      }
      
      // Animar la aparici贸n/desaparici贸n
      if (isHidden) {
        el.style.opacity = "0";
        setTimeout(() => {
          el.style.transition = "opacity 0.3s ease";
          el.style.opacity = "1";
        }, 10);
      }
    }

    function showError(message) {
      const container = document.getElementById("error-container");
      container.style.display = "block";
      container.innerHTML = `
        <div class="error">
          <i class="fas fa-exclamation-triangle"></i>
          <p>${message}</p>
          <button class="refresh-btn" onclick="loadData()">
            <i class="fas fa-redo"></i> Reintentar
          </button>
        </div>
      `;
    }

    async function loadData() {
      try {
        // Ocultar cualquier error anterior
        document.getElementById("error-container").style.display = "none";
        
        const res = await fetch(SPREADSHEET_URL);
        
        if (!res.ok) {
          throw new Error(`Error HTTP: ${res.status}`);
        }
        
        const text = await res.text();
        
        if (!text || text.trim().length === 0) {
          throw new Error("La hoja de c谩lculo est谩 vac铆a o no se pudo acceder");
        }
        
        const rows = text.split("\n").map(r => r.split(","));
        
        if (rows.length < 2) {
          throw new Error("Formato de datos incorrecto");
        }
        
        const keys = rows[0];
        const values = rows[1];
        const data = {};
        keys.forEach((k,i) => data[k.trim()] = values[i]?.trim());

        // Renderizar datos
        renderCards("cards-generales", headers.generales, data);
        renderCards("cards-trenes", headers.trenes, data);
        renderCards("cards-guardiolas", headers.guardiolas.general, data);

        // Configurar filtro de guardiolas
        document.getElementById("guardiolas-filter").addEventListener("change", (e)=>{
          const value = e.target.value;
          if(value==="directas") renderCards("cards-guardiolas", headers.guardiolas.directas, data);
          else if(value==="completos") renderCards("cards-guardiolas", headers.guardiolas.completos, data);
          else renderCards("cards-guardiolas", headers.guardiolas.general, data);
        });

      } catch(err) {
        console.error("Error cargando datos:", err);
        showError(`No se pudieron cargar los datos: ${err.message}`);
      }
    }

    // Cargar datos al iniciar y cada 5 minutos
    loadData();
    setInterval(loadData, 5 * 60 * 1000);
    
    // Mejorar experiencia t谩ctil
    document.addEventListener('touchstart', function() {}, {passive: true});
  </script>

</body>
</html>